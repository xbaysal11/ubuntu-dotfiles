module.exports=function(e){var t={};function n(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(s,r,function(t){return e[t]}.bind(null,r));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t){e.exports=require("path")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(12),r=n(2),i=n(5),o=n(13);t.Source=class{constructor(e,t,n=0,s,r){this.name=e,this.path=t,this.sourceReference=n,s&&(this.origin=s),r&&(this.adapterData=r)}};t.Scope=class{constructor(e,t,n=!1){this.name=e,this.variablesReference=t,this.expensive=n}};t.StackFrame=class{constructor(e,t,n,s=0,r=0){this.id=e,this.source=n,this.line=s,this.column=r,this.name=t}};t.Thread=class{constructor(e,t){this.id=e,this.name=t||"Thread #"+e}};t.Variable=class{constructor(e,t,n=0,s,r){this.name=e,this.value=t,this.variablesReference=n,"number"==typeof r&&(this.namedVariables=r),"number"==typeof s&&(this.indexedVariables=s)}};t.Breakpoint=class{constructor(e,t,n,s){this.verified=e;const r=this;"number"==typeof t&&(r.line=t),"number"==typeof n&&(r.column=n),s&&(r.source=s)}};t.Module=class{constructor(e,t){this.id=e,this.name=t}};t.CompletionItem=class{constructor(e,t,n=0){this.label=e,this.start=t,this.length=n}};t.StoppedEvent=class extends r.Event{constructor(e,t,n){super("stopped"),this.body={reason:e},"number"==typeof t&&(this.body.threadId=t),"string"==typeof n&&(this.body.text=n)}};t.ContinuedEvent=class extends r.Event{constructor(e,t){super("continued"),this.body={threadId:e},"boolean"==typeof t&&(this.body.allThreadsContinued=t)}};t.InitializedEvent=class extends r.Event{constructor(){super("initialized")}};t.TerminatedEvent=class extends r.Event{constructor(e){if(super("terminated"),"boolean"==typeof e||e){this.body={restart:e}}}};t.OutputEvent=class extends r.Event{constructor(e,t="console",n){super("output"),this.body={category:t,output:e},void 0!==n&&(this.body.data=n)}};t.ThreadEvent=class extends r.Event{constructor(e,t){super("thread"),this.body={reason:e,threadId:t}}};t.BreakpointEvent=class extends r.Event{constructor(e,t){super("breakpoint"),this.body={reason:e,breakpoint:t}}};t.ModuleEvent=class extends r.Event{constructor(e,t){super("module"),this.body={reason:e,module:t}}};t.LoadedSourceEvent=class extends r.Event{constructor(e,t){super("loadedSource"),this.body={reason:e,source:t}}};var a;t.CapabilitiesEvent=class extends r.Event{constructor(e){super("capabilities"),this.body={capabilities:e}}},function(e){e[e.User=1]="User",e[e.Telemetry=2]="Telemetry"}(a=t.ErrorDestination||(t.ErrorDestination={}));class u extends s.ProtocolServer{constructor(e,t){super();const n="boolean"==typeof e&&e;this._debuggerLinesStartAt1=n,this._debuggerColumnsStartAt1=n,this._debuggerPathsAreURIs=!1,this._clientLinesStartAt1=!0,this._clientColumnsStartAt1=!0,this._clientPathsAreURIs=!1,this._isServer="boolean"==typeof t&&t,this.on("close",()=>{this.shutdown()}),this.on("error",e=>{this.shutdown()})}setDebuggerPathFormat(e){this._debuggerPathsAreURIs="path"!==e}setDebuggerLinesStartAt1(e){this._debuggerLinesStartAt1=e}setDebuggerColumnsStartAt1(e){this._debuggerColumnsStartAt1=e}setRunAsServer(e){this._isServer=e}static run(e){let t=0;if(process.argv.slice(2).forEach(function(e,n,s){const r=/^--server=(\d{4,5})$/.exec(e);r&&(t=parseInt(r[1],10))}),t>0)console.error(`waiting for debug protocol on port ${t}`),i.createServer(t=>{console.error(">> accepted connection from client"),t.on("end",()=>{console.error(">> client connection closed\n")});const n=new e(!1,!0);n.setRunAsServer(!0),n.start(t,t)}).listen(t);else{const t=new e(!1);process.on("SIGTERM",()=>{t.shutdown()}),t.start(process.stdin,process.stdout)}}shutdown(){this._isServer||setTimeout(()=>{process.exit(0)},100)}sendErrorResponse(e,t,n,s,r=a.User){let i;"number"==typeof t?(i={id:t,format:n},s&&(i.variables=s),r&a.User&&(i.showUser=!0),r&a.Telemetry&&(i.sendTelemetry=!0)):i=t,e.success=!1,e.message=u.formatPII(i.format,!0,i.variables),e.body||(e.body={}),e.body.error=i,this.sendResponse(e)}runInTerminalRequest(e,t,n){this.sendRequest("runInTerminal",e,t,n)}dispatchRequest(e){const t=new r.Response(e);try{if("initialize"===e.command){var n=e.arguments;if("boolean"==typeof n.linesStartAt1&&(this._clientLinesStartAt1=n.linesStartAt1),"boolean"==typeof n.columnsStartAt1&&(this._clientColumnsStartAt1=n.columnsStartAt1),"path"!==n.pathFormat)this.sendErrorResponse(t,2018,"debug adapter only supports native paths",null,a.Telemetry);else{const e=t;e.body={},this.initializeRequest(e,n)}}else"launch"===e.command?this.launchRequest(t,e.arguments):"attach"===e.command?this.attachRequest(t,e.arguments):"disconnect"===e.command?this.disconnectRequest(t,e.arguments):"terminate"===e.command?this.terminateRequest(t,e.arguments):"restart"===e.command?this.restartRequest(t,e.arguments):"setBreakpoints"===e.command?this.setBreakPointsRequest(t,e.arguments):"setFunctionBreakpoints"===e.command?this.setFunctionBreakPointsRequest(t,e.arguments):"setExceptionBreakpoints"===e.command?this.setExceptionBreakPointsRequest(t,e.arguments):"configurationDone"===e.command?this.configurationDoneRequest(t,e.arguments):"continue"===e.command?this.continueRequest(t,e.arguments):"next"===e.command?this.nextRequest(t,e.arguments):"stepIn"===e.command?this.stepInRequest(t,e.arguments):"stepOut"===e.command?this.stepOutRequest(t,e.arguments):"stepBack"===e.command?this.stepBackRequest(t,e.arguments):"reverseContinue"===e.command?this.reverseContinueRequest(t,e.arguments):"restartFrame"===e.command?this.restartFrameRequest(t,e.arguments):"goto"===e.command?this.gotoRequest(t,e.arguments):"pause"===e.command?this.pauseRequest(t,e.arguments):"stackTrace"===e.command?this.stackTraceRequest(t,e.arguments):"scopes"===e.command?this.scopesRequest(t,e.arguments):"variables"===e.command?this.variablesRequest(t,e.arguments):"setVariable"===e.command?this.setVariableRequest(t,e.arguments):"setExpression"===e.command?this.setExpressionRequest(t,e.arguments):"source"===e.command?this.sourceRequest(t,e.arguments):"threads"===e.command?this.threadsRequest(t):"terminateThreads"===e.command?this.terminateThreadsRequest(t,e.arguments):"evaluate"===e.command?this.evaluateRequest(t,e.arguments):"stepInTargets"===e.command?this.stepInTargetsRequest(t,e.arguments):"gotoTargets"===e.command?this.gotoTargetsRequest(t,e.arguments):"completions"===e.command?this.completionsRequest(t,e.arguments):"exceptionInfo"===e.command?this.exceptionInfoRequest(t,e.arguments):"loadedSources"===e.command?this.loadedSourcesRequest(t,e.arguments):"dataBreakpointInfo"===e.command?this.dataBreakpointInfoRequest(t,e.arguments):"setDataBreakpoints"===e.command?this.setDataBreakpointsRequest(t,e.arguments):"readMemory"===e.command?this.readMemoryRequest(t,e.arguments):"disassemble"===e.command?this.disassembleRequest(t,e.arguments):this.customRequest(e.command,t,e.arguments)}catch(e){this.sendErrorResponse(t,1104,"{_stack}",{_exception:e.message,_stack:e.stack},a.Telemetry)}}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,e.body.supportsRestartRequest=!1,e.body.supportsExceptionOptions=!1,e.body.supportsValueFormattingOptions=!1,e.body.supportsExceptionInfoRequest=!1,e.body.supportTerminateDebuggee=!1,e.body.supportsDelayedStackTraceLoading=!1,e.body.supportsLoadedSourcesRequest=!1,e.body.supportsLogPoints=!1,e.body.supportsTerminateThreadsRequest=!1,e.body.supportsSetExpression=!1,e.body.supportsTerminateRequest=!1,e.body.supportsDataBreakpoints=!1,e.body.supportsReadMemoryRequest=!1,e.body.supportsDisassembleRequest=!1,this.sendResponse(e)}disconnectRequest(e,t){this.sendResponse(e),this.shutdown()}launchRequest(e,t){this.sendResponse(e)}attachRequest(e,t){this.sendResponse(e)}terminateRequest(e,t){this.sendResponse(e)}restartRequest(e,t){this.sendResponse(e)}setBreakPointsRequest(e,t){this.sendResponse(e)}setFunctionBreakPointsRequest(e,t){this.sendResponse(e)}setExceptionBreakPointsRequest(e,t){this.sendResponse(e)}configurationDoneRequest(e,t){this.sendResponse(e)}continueRequest(e,t){this.sendResponse(e)}nextRequest(e,t){this.sendResponse(e)}stepInRequest(e,t){this.sendResponse(e)}stepOutRequest(e,t){this.sendResponse(e)}stepBackRequest(e,t){this.sendResponse(e)}reverseContinueRequest(e,t){this.sendResponse(e)}restartFrameRequest(e,t){this.sendResponse(e)}gotoRequest(e,t){this.sendResponse(e)}pauseRequest(e,t){this.sendResponse(e)}sourceRequest(e,t){this.sendResponse(e)}threadsRequest(e){this.sendResponse(e)}terminateThreadsRequest(e,t){this.sendResponse(e)}stackTraceRequest(e,t){this.sendResponse(e)}scopesRequest(e,t){this.sendResponse(e)}variablesRequest(e,t){this.sendResponse(e)}setVariableRequest(e,t){this.sendResponse(e)}setExpressionRequest(e,t){this.sendResponse(e)}evaluateRequest(e,t){this.sendResponse(e)}stepInTargetsRequest(e,t){this.sendResponse(e)}gotoTargetsRequest(e,t){this.sendResponse(e)}completionsRequest(e,t){this.sendResponse(e)}exceptionInfoRequest(e,t){this.sendResponse(e)}loadedSourcesRequest(e,t){this.sendResponse(e)}dataBreakpointInfoRequest(e,t){this.sendResponse(e)}setDataBreakpointsRequest(e,t){this.sendResponse(e)}readMemoryRequest(e,t){this.sendResponse(e)}disassembleRequest(e,t){this.sendResponse(e)}customRequest(e,t,n){this.sendErrorResponse(t,1014,"unrecognized request",null,a.Telemetry)}convertClientLineToDebugger(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e+1:this._clientLinesStartAt1?e-1:e}convertDebuggerLineToClient(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e-1:this._clientLinesStartAt1?e+1:e}convertClientColumnToDebugger(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e+1:this._clientColumnsStartAt1?e-1:e}convertDebuggerColumnToClient(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e-1:this._clientColumnsStartAt1?e+1:e}convertClientPathToDebugger(e){return this._clientPathsAreURIs!==this._debuggerPathsAreURIs?this._clientPathsAreURIs?u.uri2path(e):u.path2uri(e):e}convertDebuggerPathToClient(e){return this._debuggerPathsAreURIs!==this._clientPathsAreURIs?this._debuggerPathsAreURIs?u.uri2path(e):u.path2uri(e):e}static path2uri(e){"win32"===process.platform&&(/^[A-Z]:/.test(e)&&(e=e[0].toLowerCase()+e.substr(1)),e=e.replace(/\\/g,"/")),e=encodeURI(e);let t=new o.URL("file:");return t.pathname=e,t.toString()}static uri2path(e){let t=new o.URL(e),n=decodeURIComponent(t.pathname);return"win32"===process.platform&&(/^\/[a-zA-Z]:/.test(n)&&(n=n[1].toLowerCase()+n.substr(2)),n=n.replace(/\//g,"\\")),n}static formatPII(e,t,n){return e.replace(u._formatPIIRegexp,function(e,s){return t&&s.length>0&&"_"!==s[0]?e:n[s]&&n.hasOwnProperty(s)?n[s]:e})}}u._formatPIIRegexp=/{([^}]+)}/g,t.DebugSession=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(e){this.seq=0,this.type=e}}t.Message=s;t.Response=class extends s{constructor(e,t){super("response"),this.request_seq=e.seq,this.command=e.command,t?(this.success=!1,this.message=t):this.success=!0}};t.Event=class extends s{constructor(e,t){super("event"),this.event=e,t&&(this.body=t)}}},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("net")},function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))(function(r,i){function o(e){try{u(s.next(e))}catch(e){i(e)}}function a(e){try{u(s.throw(e))}catch(e){i(e)}}function u(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,a)}u((s=s.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=n(3),i=n(0),o=n(15),a=n(1);var u;!function(e){e[e.Verbose=0]="Verbose",e[e.Log=1]="Log",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Stop=4]="Stop"}(u=t.LogLevel||(t.LogLevel={}));class c{constructor(){this._pendingLogQ=[]}log(e,t=u.Log){e+="\n",this._write(e,t)}verbose(e){this.log(e,u.Verbose)}warn(e){this.log(e,u.Warn)}error(e){this.log(e,u.Error)}dispose(){if(this._currentLogger){const e=this._currentLogger.dispose();return this._currentLogger=null,e}return Promise.resolve()}_write(e,t=u.Log){e+="",this._pendingLogQ?this._pendingLogQ.push({msg:e,level:t}):this._currentLogger&&this._currentLogger.log(e,t)}setup(e,t,n=!0){const s="string"==typeof t?t:t&&this._logFilePathFromInit;if(this._currentLogger){const t={consoleMinLogLevel:e,logFilePath:s,prependTimestamp:n};this._currentLogger.setup(t).then(()=>{if(this._pendingLogQ){const e=this._pendingLogQ;this._pendingLogQ=null,e.forEach(e=>this._write(e.msg,e.level))}})}}init(e,t,n){this._pendingLogQ=this._pendingLogQ||[],this._currentLogger=new l(e,n),this._logFilePathFromInit=t}}t.Logger=c,t.logger=new c;class l{constructor(e,t){this.beforeExitCallback=()=>this.dispose(),this._logCallback=e,this._logToConsole=t,this._minLogLevel=u.Warn,this.disposeCallback=(e,t)=>{this.dispose(),t=t||2,t+=128,process.exit(t)}}setup(e){return s(this,void 0,void 0,function*(){if(this._minLogLevel=e.consoleMinLogLevel,this._prependTimestamp=e.prependTimestamp,e.logFilePath)if(i.isAbsolute(e.logFilePath)){const n=t=>this.sendLog(`Error creating log file at path: ${e.logFilePath}. Error: ${t.toString()}\n`,u.Error);try{yield(t=i.dirname(e.logFilePath),new Promise((e,n)=>{o(t,t=>{t?n(t):e()})})),this.log("Verbose logs are written to:\n",u.Warn),this.log(e.logFilePath+"\n",u.Warn),this._logFileStream=r.createWriteStream(e.logFilePath),this.logDateTime(),this.setupShutdownListeners(),this._logFileStream.on("error",e=>{n(e)})}catch(e){n(e)}}else this.log(`logFilePath must be an absolute path: ${e.logFilePath}`,u.Error);var t})}logDateTime(){let e=new Date;const t=e.getUTCFullYear()+"-"+`${e.getUTCMonth()+1}`+"-"+e.getUTCDate()+", "+p();this.log(t+"\n",u.Verbose,!1)}setupShutdownListeners(){process.addListener("beforeExit",this.beforeExitCallback),process.addListener("SIGTERM",this.disposeCallback),process.addListener("SIGINT",this.disposeCallback)}removeShutdownListeners(){process.removeListener("beforeExit",this.beforeExitCallback),process.removeListener("SIGTERM",this.disposeCallback),process.removeListener("SIGINT",this.disposeCallback)}dispose(){return new Promise(e=>{this.removeShutdownListeners(),this._logFileStream?(this._logFileStream.end(e),this._logFileStream=null):e()})}log(e,t,n=!0){if(this._minLogLevel!==u.Stop){if(t>=this._minLogLevel&&this.sendLog(e,t),this._logToConsole){const n=t===u.Error?console.error:t===u.Warn?console.warn:null;n&&n(d(e))}t===u.Error&&(e=`[${u[t]}] ${e}`),this._prependTimestamp&&n&&(e="["+p()+"] "+e),this._logFileStream&&this._logFileStream.write(e)}}sendLog(e,t){if(e.length>1500){const t=!!e.match(/(\n|\r\n)$/);e=e.substr(0,1500)+"[...]",t&&(e+="\n")}if(this._logCallback){const n=new h(e,t);this._logCallback(n)}}}class h extends a.OutputEvent{constructor(e,t){super(e,t===u.Error?"stderr":t===u.Warn?"console":"stdout")}}function d(e){return e.replace(/(\n|\r\n)$/,"")}function p(){let e=new Date;return m(2,String(e.getUTCHours()))+":"+m(2,String(e.getUTCMinutes()))+":"+m(2,String(e.getUTCSeconds()))+"."+m(3,String(e.getUTCMilliseconds()))+" UTC"}function m(e,t){return t.length>=e?t:String("0".repeat(e)+t).slice(-e)}t.LogOutputEvent=h,t.trimLastNewline=d},function(e,t){function n(e,t){for(var n in e)t[n]=e[n]}function s(e,t){var s=e.prototype;if(Object.create){var r=Object.create(t.prototype);s.__proto__=r}if(!(s instanceof t)){function i(){}i.prototype=t.prototype,n(s,i=new i),e.prototype=s=i}s.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),s.constructor=e)}var r="http://www.w3.org/1999/xhtml",i={},o=i.ELEMENT_NODE=1,a=i.ATTRIBUTE_NODE=2,u=i.TEXT_NODE=3,c=i.CDATA_SECTION_NODE=4,l=i.ENTITY_REFERENCE_NODE=5,h=i.ENTITY_NODE=6,d=i.PROCESSING_INSTRUCTION_NODE=7,p=i.COMMENT_NODE=8,m=i.DOCUMENT_NODE=9,f=i.DOCUMENT_TYPE_NODE=10,g=i.DOCUMENT_FRAGMENT_NODE=11,b=i.NOTATION_NODE=12,v={},R={},E=(v.INDEX_SIZE_ERR=(R[1]="Index size error",1),v.DOMSTRING_SIZE_ERR=(R[2]="DOMString size error",2),v.HIERARCHY_REQUEST_ERR=(R[3]="Hierarchy request error",3)),w=(v.WRONG_DOCUMENT_ERR=(R[4]="Wrong document",4),v.INVALID_CHARACTER_ERR=(R[5]="Invalid character",5),v.NO_DATA_ALLOWED_ERR=(R[6]="No data allowed",6),v.NO_MODIFICATION_ALLOWED_ERR=(R[7]="No modification allowed",7),v.NOT_FOUND_ERR=(R[8]="Not found",8)),y=(v.NOT_SUPPORTED_ERR=(R[9]="Not supported",9),v.INUSE_ATTRIBUTE_ERR=(R[10]="Attribute in use",10));v.INVALID_STATE_ERR=(R[11]="Invalid state",11),v.SYNTAX_ERR=(R[12]="Syntax error",12),v.INVALID_MODIFICATION_ERR=(R[13]="Invalid modification",13),v.NAMESPACE_ERR=(R[14]="Invalid namespace",14),v.INVALID_ACCESS_ERR=(R[15]="Invalid access",15);function _(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,R[e]),this.message=R[e],Error.captureStackTrace&&Error.captureStackTrace(this,_);return n.code=e,t&&(this.message=this.message+": "+t),n}function S(){}function N(e,t){this._node=e,this._refresh=t,x(this)}function x(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var s=e._refresh(e._node);ne(e,"length",s.length),n(s,e),e._inc=t}}function T(){}function C(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function D(e,t,n,s){if(s?t[C(t,s)]=n:t[t.length++]=n,e){n.ownerElement=e;var r=e.ownerDocument;r&&(s&&L(r,e,s),function(e,t,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&(t._nsMap[n.prefix?n.localName:""]=n.value)}(r,e,n))}}function q(e,t,n){var s=C(t,n);if(!(s>=0))throw _(w,new Error(e.tagName+"@"+n));for(var r=t.length-1;s<r;)t[s]=t[++s];if(t.length=r,e){var i=e.ownerDocument;i&&(L(i,e,n),n.ownerElement=null)}}function I(e){if(this._features={},e)for(var t in e)this._features=e[t]}function P(){}function A(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function k(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(k(e,t))return!0}while(e=e.nextSibling)}function O(){}function L(e,t,n,s){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&delete t._nsMap[n.prefix?n.localName:""]}function M(e,t,n){if(e&&e._inc){e._inc++;var s=t.childNodes;if(n)s[s.length++]=n;else{for(var r=t.firstChild,i=0;r;)s[i++]=r,r=r.nextSibling;s.length=i}}}function F(e,t){var n=t.previousSibling,s=t.nextSibling;return n?n.nextSibling=s:e.firstChild=s,s?s.previousSibling=n:e.lastChild=n,M(e.ownerDocument,e),t}function B(e,t,n){var s=t.parentNode;if(s&&s.removeChild(t),t.nodeType===g){var r=t.firstChild;if(null==r)return t;var i=t.lastChild}else r=i=t;var o=n?n.previousSibling:e.lastChild;r.previousSibling=o,i.nextSibling=n,o?o.nextSibling=r:e.firstChild=r,null==n?e.lastChild=i:n.previousSibling=i;do{r.parentNode=e}while(r!==i&&(r=r.nextSibling));return M(e.ownerDocument||e,e),t.nodeType==g&&(t.firstChild=t.lastChild=null),t}function U(){this._nsMap={}}function j(){}function $(){}function V(){}function H(){}function W(){}function z(){}function G(){}function Q(){}function X(){}function Y(){}function J(){}function Z(){}function K(e,t){var n=[],s=9==this.nodeType?this.documentElement:this,r=s.prefix,i=s.namespaceURI;if(i&&null==r&&null==(r=s.lookupPrefix(i)))var o=[{namespace:i,prefix:null}];return te(this,n,e,t,o),n.join("")}function ee(e,t,n){var s=e.prefix||"",r=e.namespaceURI;if(!s&&!r)return!1;if("xml"===s&&"http://www.w3.org/XML/1998/namespace"===r||"http://www.w3.org/2000/xmlns/"==r)return!1;for(var i=n.length;i--;){var o=n[i];if(o.prefix==s)return o.namespace!=r}return!0}function te(e,t,n,s,i){if(s){if(!(e=s(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case o:i||(i=[]);i.length;var h=e.attributes,b=h.length,v=e.firstChild,R=e.tagName;n=r===e.namespaceURI||n,t.push("<",R);for(var E=0;E<b;E++){"xmlns"==(w=h.item(E)).prefix?i.push({prefix:w.localName,namespace:w.value}):"xmlns"==w.nodeName&&i.push({prefix:"",namespace:w.value})}for(E=0;E<b;E++){var w;if(ee(w=h.item(E),0,i)){var y=w.prefix||"",_=w.namespaceURI,S=y?" xmlns:"+y:" xmlns";t.push(S,'="',_,'"'),i.push({prefix:y,namespace:_})}te(w,t,n,s,i)}if(ee(e,0,i)){y=e.prefix||"",_=e.namespaceURI,S=y?" xmlns:"+y:" xmlns";t.push(S,'="',_,'"'),i.push({prefix:y,namespace:_})}if(v||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(R)){if(t.push(">"),n&&/^script$/i.test(R))for(;v;)v.data?t.push(v.data):te(v,t,n,s,i),v=v.nextSibling;else for(;v;)te(v,t,n,s,i),v=v.nextSibling;t.push("</",R,">")}else t.push("/>");return;case m:case g:for(v=e.firstChild;v;)te(v,t,n,s,i),v=v.nextSibling;return;case a:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,A),'"');case u:return t.push(e.data.replace(/[<&]/g,A));case c:return t.push("<![CDATA[",e.data,"]]>");case p:return t.push("\x3c!--",e.data,"--\x3e");case f:var N=e.publicId,x=e.systemId;if(t.push("<!DOCTYPE ",e.name),N)t.push(' PUBLIC "',N),x&&"."!=x&&t.push('" "',x),t.push('">');else if(x&&"."!=x)t.push(' SYSTEM "',x,'">');else{var T=e.internalSubset;T&&t.push(" [",T,"]"),t.push(">")}return;case d:return t.push("<?",e.target," ",e.data,"?>");case l:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function ne(e,t,n){e[t]=n}_.prototype=Error.prototype,n(v,_),S.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var n=[],s=0;s<this.length;s++)te(this[s],n,e,t);return n.join("")}},N.prototype.item=function(e){return x(this),this[e]},s(N,S),T.prototype={length:0,item:S.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new _(y);var n=this.getNamedItem(e.nodeName);return D(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new _(y);return t=this.getNamedItemNS(e.namespaceURI,e.localName),D(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return q(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return q(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var s=this[n];if(s.localName==t&&s.namespaceURI==e)return s}return null}},I.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return!(!n||t&&!(t in n))},createDocument:function(e,t,n){var s=new O;if(s.implementation=this,s.childNodes=new S,s.doctype=n,n&&s.appendChild(n),t){var r=s.createElementNS(e,t);s.appendChild(r)}return s},createDocumentType:function(e,t,n){var s=new z;return s.name=e,s.nodeName=e,s.publicId=t,s.systemId=n,s}},P.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return B(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return F(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,n,s){var r=new n.constructor;for(var i in n){var u=n[i];"object"!=typeof u&&u!=r[i]&&(r[i]=u)}n.childNodes&&(r.childNodes=new S);r.ownerDocument=t;switch(r.nodeType){case o:var c=n.attributes,l=r.attributes=new T,h=c.length;l._ownerElement=r;for(var d=0;d<h;d++)r.setAttributeNode(e(t,c.item(d),!0));break;case a:s=!0}if(s)for(var p=n.firstChild;p;)r.appendChild(e(t,p,s)),p=p.nextSibling;return r}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==u&&e.nodeType==u?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var s in n)if(n[s]==e)return s;t=t.nodeType==a?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n)return n[e];t=t.nodeType==a?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},n(i,P),n(i,P.prototype),O.prototype={nodeName:"#document",nodeType:m,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==g){for(var n=e.firstChild;n;){var s=n.nextSibling;this.insertBefore(n,t),n=s}return e}return null==this.documentElement&&e.nodeType==o&&(this.documentElement=e),B(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),F(this,e)},importNode:function(e,t){return function e(t,n,s){var r;switch(n.nodeType){case o:(r=n.cloneNode(!1)).ownerDocument=t;case g:break;case a:s=!0}r||(r=n.cloneNode(!1));r.ownerDocument=t;r.parentNode=null;if(s)for(var i=n.firstChild;i;)r.appendChild(e(t,i,s)),i=i.nextSibling;return r}(this,e,t)},getElementById:function(e){var t=null;return k(this.documentElement,function(n){if(n.nodeType==o&&n.getAttribute("id")==e)return t=n,!0}),t},createElement:function(e){var t=new U;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new S,(t.attributes=new T)._ownerElement=t,t},createDocumentFragment:function(){var e=new Y;return e.ownerDocument=this,e.childNodes=new S,e},createTextNode:function(e){var t=new V;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new H;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new W;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new J;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new j;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new X;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new U,s=t.split(":"),r=n.attributes=new T;return n.childNodes=new S,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==s.length?(n.prefix=s[0],n.localName=s[1]):n.localName=t,r._ownerElement=n,n},createAttributeNS:function(e,t){var n=new j,s=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==s.length?(n.prefix=s[0],n.localName=s[1]):n.localName=t,n}},s(O,P),U.prototype={nodeType:o,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===g?this.insertBefore(e,null):function(e,t){var n=t.parentNode;if(n){var s=e.lastChild;n.removeChild(t);s=e.lastChild}return s=e.lastChild,t.parentNode=e,t.previousSibling=s,t.nextSibling=null,s?s.nextSibling=t:e.firstChild=t,e.lastChild=t,M(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var s=this.ownerDocument.createAttributeNS(e,t);s.value=s.nodeValue=""+n,this.setAttributeNode(s)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new N(this,function(t){var n=[];return k(t,function(s){s===t||s.nodeType!=o||"*"!==e&&s.tagName!=e||n.push(s)}),n})},getElementsByTagNameNS:function(e,t){return new N(this,function(n){var s=[];return k(n,function(r){r===n||r.nodeType!==o||"*"!==e&&r.namespaceURI!==e||"*"!==t&&r.localName!=t||s.push(r)}),s})}},O.prototype.getElementsByTagName=U.prototype.getElementsByTagName,O.prototype.getElementsByTagNameNS=U.prototype.getElementsByTagNameNS,s(U,P),j.prototype.nodeType=a,s(j,P),$.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(R[E])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},s($,P),V.prototype={nodeName:"#text",nodeType:u,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var s=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(s,this.nextSibling),s}},s(V,$),H.prototype={nodeName:"#comment",nodeType:p},s(H,$),W.prototype={nodeName:"#cdata-section",nodeType:c},s(W,$),z.prototype.nodeType=f,s(z,P),G.prototype.nodeType=b,s(G,P),Q.prototype.nodeType=h,s(Q,P),X.prototype.nodeType=l,s(X,P),Y.prototype.nodeName="#document-fragment",Y.prototype.nodeType=g,s(Y,P),J.prototype.nodeType=d,s(J,P),Z.prototype.serializeToString=function(e,t,n){return K.call(e,t,n)},P.prototype.toString=K;try{if(Object.defineProperty){Object.defineProperty(N.prototype,"length",{get:function(){return x(this),this.$$length}}),Object.defineProperty(P.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case o:case g:var n=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&n.push(e(t)),t=t.nextSibling;return n.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case o:case g:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),ne=function(e,t,n){e["$$"+t]=n}}}catch(e){}t.DOMImplementation=I,t.XMLSerializer=Z},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ready=0]="ready",e[e.connected=1]="connected",e[e.closed=2]="closed"}(t.SocketClientState||(t.SocketClientState={})),function(e){e[e.launch=0]="launch",e[e.attach=1]="attach"}(t.Mode||(t.Mode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startsWith=function(e,t,n){return n=n||0,e.substr(n,t.length)===t},t.endsWith=function(e,t,n){var s=e.toString();("number"!=typeof n||!isFinite(n)||Math.floor(n)!==n||n>s.length)&&(n=s.length),n-=t.length;var r=s.indexOf(t,n);return-1!==r&&r===n},t.includes=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}},function(e,t,n){"use strict";var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const r=n(11),i=n(3),o=n(0),a=s(n(0)),u=n(17),c=n(8),l=n(9);class h{constructor(e,t,n,s){this.line=e,this.column=t,this.condition=n,this.id=s}static fromSourceBreakpoint(e){return new h(e.line,e.column,e.condition)}convertForResponse(){var e=new r.Breakpoint(!0,this.line,this.column);return e.id=this.id,e}}r.DebugSession.run(class extends r.DebugSession{constructor(){super(),this._breakpointId=1e3,this._threadId=2,this._frameId=0,this._firstSuspendReceived=!1,this._activeFileData=new Map,this._existingBreakpoints=new Map,this.setDebuggerLinesStartAt1(!0),this.setDebuggerColumnsStartAt1(!1),this._variableHandles=new r.Handles}initializeRequest(e,t){e.body.supportsConfigurationDoneRequest=!0,e.body.supportsConditionalBreakpoints=!0,this.sendResponse(e)}setupProcessHanlders(){this.rubyProcess.on("debuggerComplete",()=>{this.sendEvent(new r.TerminatedEvent)}).on("debuggerProcessExit",()=>{this.sendEvent(new r.TerminatedEvent)}).on("executableOutput",e=>{this.sendEvent(new r.OutputEvent(e.toString(),"stdout"))}).on("executableStdErr",e=>{this.sendEvent(new r.OutputEvent(e.toString(),"stderr"))}).on("nonTerminalError",e=>{this.sendEvent(new r.OutputEvent("Debugger error: "+e+"\n","stderr"))}).on("breakpoint",e=>{this.sendEvent(new r.StoppedEvent("breakpoint",e.threadId))}).on("exception",e=>{this.sendEvent(new r.OutputEvent("\nException raised: ["+e.type+"]: "+e.message+"\n","stderr")),this.sendEvent(new r.StoppedEvent("exception",e.threadId,e.type+": "+e.message))}).on("terminalError",e=>{this.sendEvent(new r.OutputEvent("Debugger terminal error: "+e)),this.sendEvent(new r.TerminatedEvent)})}launchRequest(e,t){this.debugMode=c.Mode.launch,this.requestArguments=t,this.rubyProcess=new u.RubyProcess(c.Mode.launch,t),this.rubyProcess.on("debuggerConnect",()=>{this.sendEvent(new r.InitializedEvent),this.sendResponse(e)}).on("suspended",e=>{t.stopOnEntry&&!this._firstSuspendReceived?this.sendEvent(new r.StoppedEvent("entry",e.threadId)):this.sendEvent(new r.StoppedEvent("step",e.threadId)),this._firstSuspendReceived=!0}),this.setupProcessHanlders(),t.showDebuggerOutput&&this.rubyProcess.on("debuggerOutput",e=>{this.sendEvent(new r.OutputEvent(e.toString()+"\n","console"))})}attachRequest(e,t){this.requestArguments=t,this.debugMode=c.Mode.attach,this.rubyProcess=new u.RubyProcess(c.Mode.attach,t),this.rubyProcess.on("debuggerConnect",()=>{this.sendEvent(new r.InitializedEvent),this.sendResponse(e)}).on("suspended",e=>{this.sendEvent(new r.StoppedEvent("step",e.threadId))}),this.setupProcessHanlders()}configurationDoneRequest(e,t){this.rubyProcess.Run("start"),this.sendResponse(e)}setExceptionBreakPointsRequest(e,t){t.filters.indexOf("all")>=0?this.rubyProcess.Enqueue("catch Exception").then(()=>1):this.rubyProcess.Run("catch off"),this.sendResponse(e)}setBreakPointsRequest(e,t){var n=this.convertClientPathToKey(t.source.path),s=this._existingBreakpoints.get(n)||[],r=t.breakpoints.map(e=>h.fromSourceBreakpoint(e)),i=s.map(e=>e.line),o=r.map(e=>e.line),a=s.filter(e=>o.indexOf(e.line)<0),u=r.filter(e=>i.indexOf(e.line)<0);if(console.assert(a.length>0||u.length>0),a.length>0){var c=a.map(e=>e.line);s=s.filter(e=>c.indexOf(e.line)<0),this._existingBreakpoints.set(n,s);var l=a.map(e=>this.rubyProcess.Enqueue("delete "+e.id));Promise.all(l).then(t=>{let n=t.map(e=>+e.no),r=a.filter(e=>n.indexOf(e.id)<0);console.assert(0==r.length),e.body={breakpoints:s.map(e=>e.convertForResponse())},this.sendResponse(e)})}if(u.length>0){var d=this.convertClientPathToDebugger(t.source.path),p=u.map(e=>{let t="break "+d+":"+e.line;return e.condition&&(t+=" if "+e.condition),this.rubyProcess.Enqueue(t)});Promise.all(p).then(t=>{var r=t.map(e=>{var t=+(e.location+"").split(":").pop(),n=+e.no;return new h(t,null,null,n)});console.assert(r.length==u.length);for(let e=0;e<r.length;++e)console.assert(r[e].line==u[e].line),u[e].id=r[e].id;s=s.concat(u),this._existingBreakpoints.set(n,s),e.body={breakpoints:s.map(e=>e.convertForResponse())},this.sendResponse(e)})}}threadsRequest(e){this.rubyProcess.Enqueue("thread list").then(t=>{t&&t.length>0&&(this._threadId=t[0].id),e.body={threads:t.map(e=>new r.Thread(+e.id,"Thread "+e.id))},this.sendResponse(e)})}stackTraceRequest(e,t){this.rubyProcess.Enqueue("where").then(t=>{(t=t.filter(e=>!(l.endsWith(e.file,"/rdebug-ide",null)||l.endsWith(e.file,"/ruby-debug-ide.rb",null)))).some(e=>e.current?this._frameId=+e.no:0),t.forEach(e=>{const t=this.convertDebuggerPathToClient(e.file);!this._activeFileData.has(t)&&i.existsSync(t)&&this._activeFileData.set(t,i.readFileSync(t,"utf8").split("\n"))}),e.body={stackFrames:t.filter(e=>e.file.indexOf("debug-ide")<0&&+e.line>0).map(e=>{const t=this.convertDebuggerPathToClient(e.file),n=this._activeFileData.get(t),s=t.split("/gems/"),i=s[s.length-1];return new r.StackFrame(+e.no,n?n[+e.line-1].trim():i+":"+e.line,n?new r.Source(o.basename(e.file),t):null,this.convertDebuggerLineToClient(+e.line),0)})},e.body.stackFrames.length?this.sendResponse(e):this.sendEvent(new r.TerminatedEvent)})}convertClientPathToKey(e){return e.replace(/\\/g,"/")}isSubPath(e){return e&&!e.startsWith("..")&&!a.isAbsolute(e)}getPathImplementation(e){if(e){if(e.indexOf(a.posix.sep)>=0)return a.posix;if(e.indexOf(a.win32.sep)>=0)return a.win32}return a}convertClientPathToDebugger(e){if(this.debugMode===c.Mode.launch)return e;let t=a.relative(this.requestArguments.cwd,e);if(!this.isSubPath(t))return e;let n=this.requestArguments.remoteWorkspaceRoot||this.requestArguments.cwd,s=this.getPathImplementation(n),r=this.getPathImplementation(this.requestArguments.cwd);return s.join.apply(null,[n].concat(t.split(r.sep)))}convertDebuggerPathToClient(e){if(this.debugMode===c.Mode.launch)return e;let t=this.requestArguments.remoteWorkspaceRoot||this.requestArguments.cwd,n=this.getPathImplementation(t),s=this.getPathImplementation(this.requestArguments.cwd),r=n.relative(t,e);return this.isSubPath(r)?s.join.apply(null,[this.requestArguments.cwd].concat(r.split(n.sep))):e}switchFrame(e){e!==this._frameId&&(this._frameId=e,this.rubyProcess.Run("frame "+e))}varyVariable(e){return"String"===e.type?(e.hasChildren=!1,e.value="'"+e.value.replace(/'/g,"\\'")+"'"):e.value&&l.startsWith(e.value,"#<"+e.type,0)&&(e.value=e.type),e}createVariableReference(e){return Array.isArray(e)||(e=[]),e.map(this.varyVariable).map(e=>({name:e.name,kind:e.kind,type:e.type,value:void 0===e.value?"undefined":e.value,id:e.objectId,variablesReference:"true"===e.hasChildren?this._variableHandles.create({objectId:e.objectId}):0}))}scopesRequest(e,t){this.switchFrame(t.frameId),Promise.all([this.rubyProcess.Enqueue("var local"),this.rubyProcess.Enqueue("var global")]).then(t=>{const n=new Array;n.push(new r.Scope("Local",this._variableHandles.create({variables:this.createVariableReference(t[0])}),!1)),n.push(new r.Scope("Global",this._variableHandles.create({variables:this.createVariableReference(t[1])}),!1)),e.body={scopes:n},this.sendResponse(e)})}variablesRequest(e,t){var n=this._variableHandles.get(t.variablesReference);let s;(s=n.objectId?this.rubyProcess.Enqueue("var i "+n.objectId).then(e=>this.createVariableReference(e)):Promise.resolve(n.variables)).then(t=>{e.body={variables:t},this.sendResponse(e)})}continueRequest(e,t){this.sendResponse(e),this.rubyProcess.Run("c")}nextRequest(e,t){this.sendResponse(e),this.rubyProcess.Run("next")}stepInRequest(e){this.sendResponse(e),this.rubyProcess.Run("step")}pauseRequest(e){this.sendResponse(e),this.rubyProcess.Run("pause")}stepOutRequest(e){this.sendResponse(e),this.rubyProcess.Run("finish")}evaluateRequest(e,t){this.rubyProcess.Enqueue("eval "+t.expression).then(t=>{e.body={result:t.value?t.value:t.length>0&&t[0].value?t[0].value:"Not available",variablesReference:0},this.sendResponse(e)})}disconnectRequest(e,t){this.rubyProcess.state!==c.SocketClientState.closed&&this.rubyProcess.Run("quit"),this.sendResponse(e)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1);t.DebugSession=s.DebugSession,t.InitializedEvent=s.InitializedEvent,t.TerminatedEvent=s.TerminatedEvent,t.StoppedEvent=s.StoppedEvent,t.ContinuedEvent=s.ContinuedEvent,t.OutputEvent=s.OutputEvent,t.ThreadEvent=s.ThreadEvent,t.BreakpointEvent=s.BreakpointEvent,t.ModuleEvent=s.ModuleEvent,t.LoadedSourceEvent=s.LoadedSourceEvent,t.CapabilitiesEvent=s.CapabilitiesEvent,t.Thread=s.Thread,t.StackFrame=s.StackFrame,t.Scope=s.Scope,t.Variable=s.Variable,t.Breakpoint=s.Breakpoint,t.Source=s.Source,t.Module=s.Module,t.CompletionItem=s.CompletionItem,t.ErrorDestination=s.ErrorDestination;const r=n(14);t.LoggingDebugSession=r.LoggingDebugSession;const i=n(6);t.Logger=i;const o=n(2);t.Event=o.Event,t.Response=o.Response;const a=n(16);t.Handles=a.Handles;const u=i.logger;t.logger=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(4),r=n(2);class i extends s.EventEmitter{constructor(){super(),this._pendingRequests=new Map}start(e,t){this._sequence=1,this._writableStream=t,this._rawData=new Buffer(0),e.on("data",e=>this._handleData(e)),e.on("close",()=>{this._emitEvent(new r.Event("close"))}),e.on("error",e=>{this._emitEvent(new r.Event("error","inStream error: "+(e&&e.message)))}),t.on("error",e=>{this._emitEvent(new r.Event("error","outStream error: "+(e&&e.message)))}),e.resume()}stop(){this._writableStream&&this._writableStream.end()}sendEvent(e){this._send("event",e)}sendResponse(e){e.seq>0?console.error(`attempt to send more than one response for command ${e.command}`):this._send("response",e)}sendRequest(e,t,n,s){const i={command:e};if(t&&Object.keys(t).length>0&&(i.arguments=t),this._writableStream){if(this._send("request",i),s){this._pendingRequests.set(i.seq,s);const e=setTimeout(()=>{clearTimeout(e);const t=this._pendingRequests.get(i.seq);t&&(this._pendingRequests.delete(i.seq),t(new r.Response(i,"timeout")))},n)}}else this._emitEvent(new r.Event("error","sendRequest: No writableStream"))}dispatchRequest(e){}_emitEvent(e){this.emit(e.event,e)}_send(e,t){if(t.type=e,t.seq=this._sequence++,this._writableStream){const e=JSON.stringify(t);this._writableStream.write(`Content-Length: ${Buffer.byteLength(e,"utf8")}\r\n\r\n${e}`,"utf8")}}_handleData(e){for(this._rawData=Buffer.concat([this._rawData,e]);;){if(this._contentLength>=0){if(this._rawData.length>=this._contentLength){const e=this._rawData.toString("utf8",0,this._contentLength);if(this._rawData=this._rawData.slice(this._contentLength),this._contentLength=-1,e.length>0)try{let t=JSON.parse(e);if("request"===t.type)this.dispatchRequest(t);else if("response"===t.type){const e=t,n=this._pendingRequests.get(e.request_seq);n&&(this._pendingRequests.delete(e.request_seq),n(e))}}catch(e){this._emitEvent(new r.Event("error","Error handling data: "+(e&&e.message)))}continue}}else{const e=this._rawData.indexOf(i.TWO_CRLF);if(-1!==e){const t=this._rawData.toString("utf8",0,e).split("\r\n");for(let e=0;e<t.length;e++){const n=t[e].split(/: +/);"Content-Length"==n[0]&&(this._contentLength=+n[1])}this._rawData=this._rawData.slice(e+i.TWO_CRLF.length);continue}}break}}}i.TWO_CRLF="\r\n\r\n",t.ProtocolServer=i},function(e,t){e.exports=require("url")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(6),r=s.logger,i=n(1);t.LoggingDebugSession=class extends i.DebugSession{constructor(e,t,n){super(t,n),this.obsolete_logFilePath=e,this.on("error",e=>{r.error(e.body)})}start(e,t){super.start(e,t),r.init(e=>this.sendEvent(e),this.obsolete_logFilePath,this._isServer)}sendEvent(e){e instanceof s.LogOutputEvent||r.verbose(`To client: ${JSON.stringify(e)}`),super.sendEvent(e)}sendRequest(e,t,n,s){r.verbose(`To client: ${JSON.stringify(e)}(${JSON.stringify(t)}), timeout: ${n}`),super.sendRequest(e,t,n,s)}sendResponse(e){r.verbose(`To client: ${JSON.stringify(e)}`),super.sendResponse(e)}dispatchRequest(e){r.verbose(`From client: ${e.command}(${JSON.stringify(e.arguments)})`),super.dispatchRequest(e)}}},function(e,t,n){var s=n(0),r=n(3),i=parseInt("0777",8);function o(e,t,n,a){"function"==typeof t?(n=t,t={}):t&&"object"==typeof t||(t={mode:t});var u=t.mode,c=t.fs||r;void 0===u&&(u=i&~process.umask()),a||(a=null);var l=n||function(){};e=s.resolve(e),c.mkdir(e,u,function(n){if(!n)return l(null,a=a||e);switch(n.code){case"ENOENT":o(s.dirname(e),t,function(n,s){n?l(n,s):o(e,t,l,s)});break;default:c.stat(e,function(e,t){e||!t.isDirectory()?l(n,a):l(null,a)})}})}e.exports=o.mkdirp=o.mkdirP=o,o.sync=function e(t,n,o){n&&"object"==typeof n||(n={mode:n});var a=n.mode,u=n.fs||r;void 0===a&&(a=i&~process.umask()),o||(o=null),t=s.resolve(t);try{u.mkdirSync(t,a),o=o||t}catch(r){switch(r.code){case"ENOENT":o=e(s.dirname(t),n,o),e(t,n,o);break;default:var c;try{c=u.statSync(t)}catch(e){throw r}if(!c.isDirectory())throw r}}return o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Handles=class{constructor(e){this.START_HANDLE=1e3,this._handleMap=new Map,this._nextHandle="number"==typeof e?e:this.START_HANDLE}reset(){this._nextHandle=this.START_HANDLE,this._handleMap=new Map}create(e){var t=this._nextHandle++;return this._handleMap.set(t,e),t}get(e,t){return this._handleMap.get(e)||t}}},function(e,t,n){"use strict";var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=s(n(5)),o=s(n(18)),a=n(4),u=n(19),c=n(8),l=n(9);var h={};const d=1;t.RubyProcess=class extends a.EventEmitter{constructor(e,t){super(),this.debugSocketClient=null,this.pendingResponses=[],this.pendingCommands=[],this.socketConnected=!1,this.state=c.SocketClientState.ready,this.buffer="",this.parser=new u.DOMParser({errorHandler:(e,t)=>this.domErrorHandler(e,t),locator:h}),this.debugSocketClient=new i.Socket,this.debugSocketClient.on("connect",e=>{this.state=c.SocketClientState.connected,this.pendingCommands.forEach(e=>{this.pendingResponses.push(e),this.debugSocketClient.write(e.command+"\n")}),this.emit("debuggerConnect"),this.pendingCommands=[]}),this.debugSocketClient.on("end",e=>{this.state=c.SocketClientState.closed,this.emit("debuggerComplete")}),this.debugSocketClient.on("close",e=>{this.state=c.SocketClientState.closed}),this.debugSocketClient.on("error",e=>{var t="Client: "+e;this.emit("nonTerminalError",t)}),this.debugSocketClient.on("timeout",e=>{var t="Timeout: "+e;this.emit("nonTerminalError",t)}),this.debugSocketClient.on("data",e=>{this.buffer+=e.toString(),this.domErrors=[];var t=this.parser.parseFromString(this.buffer,"application/xml");if(this.domErrors.length){if(l.includes(this.domErrors[0].error,"unclosed xml attribute",0)||l.includes(this.domErrors[0].error,"attribute space is required",0)||l.includes(this.domErrors[0].error,"elements closed character '/' and '>' must be connected",0)||this.emit("debuggerOutput","Debugger failed to parse: "+this.domErrors[0].error+"\nFor: "+this.buffer.slice(0,20)),!(this.buffer.indexOf("<eval ")>=0&&(l.includes(this.domErrors[0].error,"attribute space is required",0)||l.includes(this.domErrors[0].error,"elements closed character '/' and '>' must be connected",0))))return;{let e=this.buffer.indexOf("<eval "),n=this.buffer.indexOf('" />',e);if(n<0)return;if((e=this.buffer.indexOf(' value="',e))<0)return;e+=8;let s=this.buffer.slice(e,n).replace(/\"/g,"&quot;");this.buffer=this.buffer.slice(0,e)+s+this.buffer.slice(n),this.domErrors=[],t=this.parser.parseFromString(this.buffer,"application/xml")}}if(!this.domErrors.length){for(let e=0;e<t.childNodes.length;e++){let n=t.childNodes[e],s={};if(n.attributes&&n.attributes.length){for(let e=0;e<n.attributes.length;e++)s[n.attributes[e].name]=n.attributes[e].value;s.threadId&&(s.threadId=+s.threadId)}if(n.childNodes&&n.childNodes.length){let e=[];for(let t=0;t<n.childNodes.length;t++){let r=n.childNodes[t];if(r.nodeType===d){if(s={},r.attributes&&r.attributes.length)for(let e=0;e<r.attributes.length;e++)s[r.attributes[e].name]=r.attributes[e].value;e.push(s)}}s=e}["breakpoint","suspended","exception"].indexOf(n.tagName)>=0?this.emit(n.tagName,s):this.FinishCmd(s)}this.buffer=""}});let n=this.executableCommandConfiguration(t);if(e==c.Mode.launch){var s,a;t.noDebug?(a=n.pathToRuby,s=[]):(a=n.rdebugIdePath,s=["--evaluation-timeout","10"],t.showDebuggerOutput&&s.push("-x"),t.debuggerPort&&"1234"!==t.debuggerPort&&(s.push("-p"),s.push(t.debuggerPort)),t.stopOnEntry&&s.push("--stop"));var p=t.cwd||r.dirname(t.program),m={};for(var f in process.env)m[f]=process.env[f];for(var f in t.env)m[f]=t.env[f];n.useBundler&&(s.unshift(a),s.unshift("exec"),a=n.pathToBundler),t.includes&&t.includes.forEach(e=>{s.push("-I"),s.push(e)}),this.debugprocess=o.spawn(a,[...s,"--",t.program,...t.args||[]],{cwd:p,env:m}),this.debugprocess.stdout.on("data",e=>{this.emit("executableOutput",e)}),this.debugprocess.stderr.on("data",e=>{/^Fast Debugger/.test(e.toString())?(this.debugSocketClient.connect(t.debuggerPort||"1234"),t.showDebuggerOutput&&this.emit("debuggerOutput",e)):this.emit("executableStdErr",e)}),this.debugprocess.on("exit",()=>{this.emit("debuggerProcessExit")}),this.debugprocess.on("error",e=>{this.emit("terminalError","Process failed: "+e.message)})}else this.debugSocketClient.connect(t.remotePort,t.remoteHost)}domErrorHandler(e,t){this.domErrors.push({lineNumber:h.lineNumber,columnNumber:h.columnNumber,error:t,type:e})}get state(){return this._state}set state(e){this._state=e}executableCommandConfiguration(e){let t,n={pathToRuby:"ruby",useBundler:!1,pathToBundler:"bundle",rdebugIdePath:t="win32"===process.platform?"rdebug-ide.bat":"rdebug-ide"};return e.pathToRuby&&(n.pathToRuby=e.pathToRuby),void 0!==e.useBundler&&(n.useBundler=e.useBundler),e.pathToBundler&&(n.pathToBundler=e.pathToBundler),e.rdebugIdePath&&(n.rdebugIdePath=e.rdebugIdePath),n}Run(e){if(this.state!==c.SocketClientState.connected){var t={command:e,resolve:()=>0,reject:()=>0};this.pendingCommands.push(t)}else this.debugSocketClient.write(e+"\n")}Enqueue(e){return new Promise((t,n)=>{var s={command:e,resolve:t,reject:n};this.state!==c.SocketClientState.connected?this.pendingCommands.push(s):(this.pendingResponses.push(s),this.debugSocketClient.write(s.command+"\n"))})}FinishCmd(e){this.pendingResponses.length>0&&(this.pendingResponses[0].resolve(e),this.pendingResponses.shift())}}},function(e,t){e.exports=require("child_process")},function(e,t,n){function s(e){this.options=e||{locator:{}}}function r(){this.cdata=!1}function i(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function o(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function a(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function u(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}s.prototype.parseFromString=function(e,t){var n=this.options,s=new c,i=n.domBuilder||new r,a=n.errorHandler,u=n.locator,l=n.xmlns||{},h={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return u&&i.setDocumentLocator(u),s.errorHandler=function(e,t,n){if(!e){if(t instanceof r)return t;e=t}var s={},i=e instanceof Function;function a(t){var r=e[t];!r&&i&&(r=2==e.length?function(n){e(t,n)}:e),s[t]=r&&function(e){r("[xmldom "+t+"]\t"+e+o(n))}||function(){}}return n=n||{},a("warning"),a("error"),a("fatalError"),s}(a,i,u),s.domBuilder=n.domBuilder||i,/\/x?html?$/.test(t)&&(h.nbsp=" ",h.copy="©",l[""]="http://www.w3.org/1999/xhtml"),l.xml=l.xml||"http://www.w3.org/XML/1998/namespace",e?s.parse(e,l,h):s.errorHandler.error("invalid doc source"),i.doc},r.prototype={startDocument:function(){this.doc=(new l).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,s){var r=this.doc,o=r.createElementNS(e,n||t),a=s.length;u(this,o),this.currentElement=o,this.locator&&i(this.locator,o);for(var c=0;c<a;c++){e=s.getURI(c);var l=s.getValue(c),h=(n=s.getQName(c),r.createAttributeNS(e,n));this.locator&&i(s.getLocator(c),h),h.value=h.nodeValue=l,o.setAttributeNode(h)}},endElement:function(e,t,n){var s=this.currentElement;s.tagName;this.currentElement=s.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&i(this.locator,n),u(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=a.apply(this,arguments)){if(this.cdata)var s=this.doc.createCDATASection(e);else s=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(s):/^\s*$/.test(e)&&this.doc.appendChild(s),this.locator&&i(this.locator,s)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=a.apply(this,arguments);var s=this.doc.createComment(e);this.locator&&i(this.locator,s),u(this,s)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var s=this.doc.implementation;if(s&&s.createDocumentType){var r=s.createDocumentType(e,t,n);this.locator&&i(this.locator,r),u(this,r)}},warning:function(e){console.warn("[xmldom warning]\t"+e,o(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,o(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,o(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){r.prototype[e]=function(){return null}});var c=n(20).XMLReader,l=t.DOMImplementation=n(7).DOMImplementation;t.XMLSerializer=n(7).XMLSerializer,t.DOMParser=s},function(e,t){var n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,s=new RegExp("[\\-\\.0-9"+n.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),r=new RegExp("^"+n.source+s.source+"*(?::"+n.source+s.source+"*)?$"),i=0,o=1,a=2,u=3,c=4,l=5,h=6,d=7;function p(){}function m(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function f(e,t,n,s,r,p){for(var m,f=++t,g=i;;){var b=e.charAt(f);switch(b){case"=":if(g===o)m=e.slice(t,f),g=u;else{if(g!==a)throw new Error("attribute equal must after attrName");g=u}break;case"'":case'"':if(g===u||g===o){if(g===o&&(p.warning('attribute value must after "="'),m=e.slice(t,f)),t=f+1,!((f=e.indexOf(b,t))>0))throw new Error("attribute value no end '"+b+"' match");v=e.slice(t,f).replace(/&#?\w+;/g,r),n.add(m,v,t-1),g=l}else{if(g!=c)throw new Error('attribute value must after "="');v=e.slice(t,f).replace(/&#?\w+;/g,r),n.add(m,v,t),p.warning('attribute "'+m+'" missed start quot('+b+")!!"),t=f+1,g=l}break;case"/":switch(g){case i:n.setTagName(e.slice(t,f));case l:case h:case d:g=d,n.closed=!0;case c:case o:case a:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return p.error("unexpected end of input"),g==i&&n.setTagName(e.slice(t,f)),f;case">":switch(g){case i:n.setTagName(e.slice(t,f));case l:case h:case d:break;case c:case o:"/"===(v=e.slice(t,f)).slice(-1)&&(n.closed=!0,v=v.slice(0,-1));case a:g===a&&(v=m),g==c?(p.warning('attribute "'+v+'" missed quot(")!!'),n.add(m,v.replace(/&#?\w+;/g,r),t)):("http://www.w3.org/1999/xhtml"===s[""]&&v.match(/^(?:disabled|checked|selected)$/i)||p.warning('attribute "'+v+'" missed value!! "'+v+'" instead!!'),n.add(v,v,t));break;case u:throw new Error("attribute value missed!!")}return f;case"":b=" ";default:if(b<=" ")switch(g){case i:n.setTagName(e.slice(t,f)),g=h;break;case o:m=e.slice(t,f),g=a;break;case c:var v=e.slice(t,f).replace(/&#?\w+;/g,r);p.warning('attribute "'+v+'" missed quot(")!!'),n.add(m,v,t);case l:g=h}else switch(g){case a:n.tagName;"http://www.w3.org/1999/xhtml"===s[""]&&m.match(/^(?:disabled|checked|selected)$/i)||p.warning('attribute "'+m+'" missed value!! "'+m+'" instead2!!'),n.add(m,m,t),t=f,g=o;break;case l:p.warning('attribute space is required"'+m+'"!!');case h:g=o,t=f;break;case u:g=c,t=f;break;case d:throw new Error("elements closed character '/' and '>' must be connected to")}}f++}}function g(e,t,n){for(var s=e.tagName,r=null,i=e.length;i--;){var o=e[i],a=o.qName,u=o.value;if((d=a.indexOf(":"))>0)var c=o.prefix=a.slice(0,d),l=a.slice(d+1),h="xmlns"===c&&l;else l=a,c=null,h="xmlns"===a&&"";o.localName=l,!1!==h&&(null==r&&(r={},R(n,n={})),n[h]=r[h]=u,o.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(h,u))}for(i=e.length;i--;){(c=(o=e[i]).prefix)&&("xml"===c&&(o.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==c&&(o.uri=n[c||""]))}var d;(d=s.indexOf(":"))>0?(c=e.prefix=s.slice(0,d),l=e.localName=s.slice(d+1)):(c=null,l=e.localName=s);var p=e.uri=n[c||""];if(t.startElement(p,l,s,e),!e.closed)return e.currentNSMap=n,e.localNSMap=r,!0;if(t.endElement(p,l,s),r)for(c in r)t.endPrefixMapping(c)}function b(e,t,n,s,r){if(/^(?:script|textarea)$/i.test(n)){var i=e.indexOf("</"+n+">",t),o=e.substring(t+1,i);if(/[&<]/.test(o))return/^script$/i.test(n)?(r.characters(o,0,o.length),i):(o=o.replace(/&#?\w+;/g,s),r.characters(o,0,o.length),i)}return t+1}function v(e,t,n,s){var r=s[n];return null==r&&((r=e.lastIndexOf("</"+n+">"))<t&&(r=e.lastIndexOf("</"+n)),s[n]=r),r<t}function R(e,t){for(var n in e)t[n]=e[n]}function E(e,t,n,s){switch(e.charAt(t+2)){case"-":return"-"===e.charAt(t+3)?(r=e.indexOf("--\x3e",t+4))>t?(n.comment(e,t+4,r-t-4),r+3):(s.error("Unclosed comment"),-1):-1;default:if("CDATA["==e.substr(t+3,6)){var r=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,r-t-9),n.endCDATA(),r+3}var i=function(e,t){var n,s=[],r=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;r.lastIndex=t,r.exec(e);for(;n=r.exec(e);)if(s.push(n),n[1])return s}(e,t),o=i.length;if(o>1&&/!doctype/i.test(i[0][0])){var a=i[1][0],u=o>3&&/^public$/i.test(i[2][0])&&i[3][0],c=o>4&&i[4][0],l=i[o-1];return n.startDTD(a,u&&u.replace(/^(['"])(.*?)\1$/,"$2"),c&&c.replace(/^(['"])(.*?)\1$/,"$2")),n.endDTD(),l.index+l[0].length}}return-1}function w(e,t,n){var s=e.indexOf("?>",t);if(s){var r=e.substring(t,s).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(r){r[0].length;return n.processingInstruction(r[1],r[2]),s+2}return-1}return-1}function y(e){}function _(e,t){return e.__proto__=t,e}p.prototype={parse:function(e,t,n){var s=this.domBuilder;s.startDocument(),R(t,t={}),function(e,t,n,s,r){function i(e){var t=e.slice(1,-1);return t in n?n[t]:"#"===t.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(r.error("entity not found:"+e),e)}function o(t){if(t>R){var n=e.substring(R,t).replace(/&#?\w+;/g,i);h&&a(R),s.characters(n,0,t-R),R=t}}function a(t,n){for(;t>=c&&(n=l.exec(e));)u=n.index,c=u+n[0].length,h.lineNumber++;h.columnNumber=t-u+1}var u=0,c=0,l=/.*(?:\r\n?|\n)|.*$/g,h=s.locator,d=[{currentNSMap:t}],p={},R=0;for(;;){try{var _=e.indexOf("<",R);if(_<0){if(!e.substr(R).match(/^\s*$/)){var S=s.doc,N=S.createTextNode(e.substr(R));S.appendChild(N),s.currentElement=N}return}switch(_>R&&o(_),e.charAt(_+1)){case"/":var x=e.indexOf(">",_+3),T=e.substring(_+2,x),C=d.pop();x<0?(T=e.substring(_+2).replace(/[\s<].*/,""),r.error("end tag name: "+T+" is not complete:"+C.tagName),x=_+1+T.length):T.match(/\s</)&&(T=T.replace(/[\s<].*/,""),r.error("end tag name: "+T+" maybe not complete"),x=_+1+T.length);var D=C.localNSMap,q=C.tagName==T;if(q||C.tagName&&C.tagName.toLowerCase()==T.toLowerCase()){if(s.endElement(C.uri,C.localName,T),D)for(var I in D)s.endPrefixMapping(I);q||r.fatalError("end tag name: "+T+" is not match the current start tagName:"+C.tagName)}else d.push(C);x++;break;case"?":h&&a(_),x=w(e,_,s);break;case"!":h&&a(_),x=E(e,_,s,r);break;default:h&&a(_);var P=new y,A=d[d.length-1].currentNSMap,k=(x=f(e,_,P,A,i,r),P.length);if(!P.closed&&v(e,x,P.tagName,p)&&(P.closed=!0,n.nbsp||r.warning("unclosed xml attribute")),h&&k){for(var O=m(h,{}),L=0;L<k;L++){var M=P[L];a(M.offset),M.locator=m(h,{})}s.locator=O,g(P,s,A)&&d.push(P),s.locator=h}else g(P,s,A)&&d.push(P);"http://www.w3.org/1999/xhtml"!==P.uri||P.closed?x++:x=b(e,x,P.tagName,i,s)}}catch(e){r.error("element parse error: "+e),x=-1}x>R?R=x:o(Math.max(_,R)+1)}}(e,t,n,s,this.errorHandler),s.endDocument()}},y.prototype={setTagName:function(e){if(!r.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,n){if(!r.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},_({},_.prototype)instanceof _||(_=function(e,t){function n(){}for(t in n.prototype=t,n=new n,e)n[t]=e[t];return n}),t.XMLReader=p}]);
//# sourceMappingURL=main.js.map